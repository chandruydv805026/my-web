<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="theme-color" content="#2ecc71">
  <title>Ratu Fresh ‚Äì ‡§Ü‡§™‡§ï‡•á ‡§ë‡§∞‡•ç‡§°‡§∞ üì¶</title>
  
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --primary: #2ecc71;
      --primary-dark: #27ae60;
      --secondary: #3498db;
      --tertiary: #e74c3c;
      --text-dark: #2c3e50;
      --text-light: #7f8c8d;
      --border-color: #ecf0f1;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --bg-light: #f5f7fa;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      color: var(--text-dark);
      min-height: 100vh;
      padding-bottom: 80px;
    }

    /* ============= NAVBAR ============= */
    nav {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      padding: 18px 20px;
      box-shadow: var(--shadow);
      text-align: center;
      color: white;
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .brand-tagline {
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 1px;
      flex: 1;
    }

    .back-btn {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .back-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateX(3px);
    }

    /* ============= POPUP ============= */
    .popup {
      position: fixed;
      bottom: -100px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--primary);
      color: #fff;
      padding: 16px 24px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 500;
      box-shadow: var(--shadow);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
      text-align: center;
      max-width: 90%;
    }

    .popup.show {
      bottom: 30px;
      opacity: 1;
    }

    .popup.error {
      background: var(--tertiary);
    }

    /* ============= SECTION ============= */
    .order-section {
      padding: 25px 15px;
      max-width: 900px;
      margin: 0 auto;
    }

    .order-section h2 {
      text-align: center;
      margin-bottom: 10px;
      font-size: 28px;
      color: var(--text-dark);
    }

    .order-subtitle {
      text-align: center;
      font-size: 14px;
      color: var(--text-light);
      margin-bottom: 25px;
    }

    /* ============= FILTERS ============= */
    .filter-section {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }

    .filter-btn {
      background: #fff;
      border: 2px solid var(--border-color);
      color: var(--text-dark);
      padding: 10px 18px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 700;
      transition: all 0.3s ease;
    }

    .filter-btn:hover,
    .filter-btn.active {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    /* ============= ORDERS GRID ============= */
    .orders-container {
      display: grid;
      grid-template-columns: 1fr;
      gap: 18px;
    }

    /* ============= ORDER CARD ============= */
    .order-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: all 0.3s ease;
      animation: slideIn 0.5s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .order-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
    }

    .order-header {
      background: linear-gradient(135deg, var(--bg-light) 0%, #e8f0f6 100%);
      padding: 18px;
      border-bottom: 2px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .order-id {
      font-size: 13px;
      color: var(--text-light);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 700;
    }

    .order-id strong {
      font-family: 'Courier New', monospace;
      color: var(--primary);
      display: block;
      font-size: 14px;
      margin-top: 4px;
    }

    .order-status {
      padding: 8px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .status-pending {
      background: rgba(243, 156, 18, 0.2);
      color: #f39c12;
    }

    .status-confirmed {
      background: rgba(52, 152, 219, 0.2);
      color: #3498db;
    }

    .status-shipped {
      background: rgba(155, 89, 182, 0.2);
      color: #9b59b6;
    }

    .status-delivered {
      background: rgba(46, 204, 113, 0.2);
      color: var(--primary);
    }

    .status-cancelled {
      background: rgba(231, 76, 60, 0.2);
      color: var(--tertiary);
    }

    /* ============= ORDER CONTENT ============= */
    .order-content {
      padding: 20px;
    }

    .order-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .info-item {
      display: flex;
      flex-direction: column;
    }

    .info-label {
      font-size: 12px;
      color: var(--text-light);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .info-value {
      font-size: 15px;
      color: var(--text-dark);
      font-weight: 600;
    }

    .info-value.amount {
      color: var(--primary);
      font-size: 18px;
    }

    /* ============= ORDER ITEMS ============= */
    .order-items {
      margin-bottom: 15px;
    }

    .items-title {
      font-size: 13px;
      color: var(--text-light);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .item-list {
      list-style: none;
    }

    .item-list li {
      padding: 10px 0;
      border-bottom: 1px solid var(--border-color);
      font-size: 14px;
      color: var(--text-dark);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .item-list li:last-child {
      border-bottom: none;
    }

    .item-name {
      flex: 1;
      font-weight: 600;
    }

    .item-qty {
      color: var(--text-light);
      font-size: 13px;
      margin: 0 12px;
    }

    /* ============= ADDRESS ============= */
    .order-address {
      background: var(--bg-light);
      padding: 14px;
      border-radius: 8px;
      font-size: 14px;
      color: var(--text-dark);
      line-height: 1.6;
      margin-top: 15px;
    }

    .address-label {
      font-size: 12px;
      color: var(--text-light);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    /* ============= ACTIONS ============= */
    .order-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .action-btn {
      flex: 1;
      padding: 10px;
      border: 2px solid var(--border-color);
      background: #fff;
      color: var(--text-dark);
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 700;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .action-btn:hover {
      border-color: var(--primary);
      color: var(--primary);
      background: rgba(46, 204, 113, 0.05);
    }

    .action-btn.primary {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    .action-btn.primary:hover {
      background: var(--primary-dark);
      border-color: var(--primary-dark);
    }

    /* ============= EMPTY STATE ============= */
    .empty-orders {
      text-align: center;
      padding: 60px 20px;
      background: #fff;
      border-radius: 12px;
      box-shadow: var(--shadow);
    }

    .empty-icon {
      font-size: 64px;
      margin-bottom: 20px;
    }

    .empty-orders h3 {
      font-size: 22px;
      color: var(--text-dark);
      margin-bottom: 10px;
    }

    .empty-orders p {
      color: var(--text-light);
      margin-bottom: 20px;
      font-size: 15px;
    }

    .empty-orders button {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 15px;
      font-weight: 700;
      transition: all 0.3s ease;
    }

    .empty-orders button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(46, 204, 113, 0.3);
    }

    /* ============= LOADING ============= */
    .loading {
      text-align: center;
      padding: 40px 20px;
      font-size: 16px;
      color: var(--text-light);
    }

    .spinner {
      display: inline-block;
      width: 40px;
      height: 40px;
      border: 4px solid rgba(46, 204, 113, 0.2);
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ============= FOOTER ============= */
    footer {
      text-align: center;
      padding: 20px;
      font-size: 12px;
      color: var(--text-light);
      background-color: #fff;
      border-top: 1px solid var(--border-color);
    }

    /* ============= RESPONSIVE ============= */
    @media (max-width: 768px) {
      .order-section h2 {
        font-size: 24px;
      }

      .order-info {
        grid-template-columns: repeat(2, 1fr);
      }

      .filter-section {
        gap: 8px;
      }

      .filter-btn {
        padding: 8px 14px;
        font-size: 12px;
      }
    }

    @media (max-width: 480px) {
      nav {
        flex-direction: column;
        gap: 10px;
      }

      .brand-tagline {
        font-size: 18px;
      }

      .order-section {
        padding: 15px 10px;
      }

      .order-section h2 {
        font-size: 20px;
      }

      .order-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }

      .order-info {
        grid-template-columns: 1fr;
        gap: 10px;
      }

      .order-content {
        padding: 15px;
      }

      .order-actions {
        flex-direction: column;
      }

      .action-btn {
        min-width: 100%;
      }

      .empty-icon {
        font-size: 48px;
      }

      .empty-orders h3 {
        font-size: 18px;
      }

      .item-list li {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }
    }
  </style>
</head>

<body>
  <!-- Navbar -->
  <nav>
    <button class="back-btn" onclick="goBack()">‚Üê Back</button>
    <div class="brand-tagline">üì¶ ‡§Ü‡§™‡§ï‡•á ‡§ë‡§∞‡•ç‡§°‡§∞</div>
    <div style="width: 50px;"></div>
  </nav>

  <!-- Popup -->
  <div id="popup" class="popup"></div>

  <!-- Main Section -->
  <section class="order-section">
    <h2>‡§Ü‡§™‡§ï‡•á ‡§π‡§æ‡§≤ ‡§ï‡•á ‡§ë‡§∞‡•ç‡§°‡§∞</h2>
    <p class="order-subtitle">‡§∏‡§≠‡•Ä ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§Ø‡§π‡§æ‡§Å ‡§è‡§ï ‡§ú‡§ó‡§π ‡§¶‡•á‡§ñ‡•á‡§Ç</p>

    <!-- Filters -->
    <div class="filter-section">
      <button class="filter-btn active" onclick="filterOrders('all')">‡§∏‡§≠‡•Ä (0)</button>
      <button class="filter-btn" onclick="filterOrders('pending')">‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ (0)</button>
      <button class="filter-btn" onclick="filterOrders('confirmed')">‡§™‡•Å‡§∑‡•ç‡§ü (0)</button>
      <button class="filter-btn" onclick="filterOrders('shipped')">‡§≠‡•á‡§ú‡•á ‡§ó‡§è (0)</button>
      <button class="filter-btn" onclick="filterOrders('delivered')">‡§™‡§π‡•Å‡§Ç‡§ö‡•á (0)</button>
    </div>

    <!-- Orders Container -->
    <div class="orders-container" id="orderList">
      <div class="loading">
        <div class="spinner"></div>
        <p style="margin-top: 15px;">‡§ë‡§∞‡•ç‡§°‡§∞ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...</p>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    ¬© 2025 Chandan Yadav, Ratu Jharkhand. All rights reserved. | üì± 24/7 ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü
  </footer>

  <script>
    // ============= CONSTANTS =============
    const API_BASE_URL = 'https://my-web-xrr5.onrender.com';
    const REQUEST_TIMEOUT = 10000;

    // ============= STATE =============
    let allOrders = [];
    let currentFilter = 'all';

    // ============= UTILITY FUNCTIONS =============
    function showPopup(message, type = 'success') {
      const popup = document.getElementById("popup");
      popup.textContent = message;
      popup.className = `popup show ${type}`;
      setTimeout(() => popup.classList.remove('show'), 3000);
      console.log(type === 'success' ? '‚úÖ' : '‚ùå', message);
    }

    function el(id) {
      return document.getElementById(id);
    }

    function goBack() {
      window.history.back();
    }

    function getStatusBadgeClass(status) {
      const statusMap = {
        'pending': 'status-pending',
        'confirmed': 'status-confirmed',
        'shipped': 'status-shipped',
        'delivered': 'status-delivered',
        'cancelled': 'status-cancelled'
      };
      return statusMap[status?.toLowerCase()] || 'status-pending';
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('hi-IN', {
        day: 'numeric',
        month: 'long',
        year: 'numeric'
      });
    }

    function formatTime(dateString) {
      const date = new Date(dateString);
      return date.toLocaleTimeString('hi-IN', {
        hour: '2-digit',
        minute: '2-digit',
        hour12: true
      });
    }

    // ============= FETCH ORDERS =============
    async function fetchOrders() {
      try {
        const user = JSON.parse(localStorage.getItem("userData"));
        const token = localStorage.getItem("token");

        if (!user || !token) {
          showPopup("‚ùå ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç", 'error');
          setTimeout(() => window.location.href = "login.html", 2000);
          return;
        }

        console.log("üîÑ Fetching orders for user:", user._id);

        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), REQUEST_TIMEOUT);

        // Mock API response (‡§ú‡§¨ ‡§§‡§ï backend ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§® ‡§π‡•ã)
        const mockOrders = [
          {
            _id: "ORD-2025-001",
            totalAmount: 450,
            status: "delivered",
            createdAt: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),
            items: [
              { name: "‡§Ü‡§≤‡•Ç", quantity: 2 },
              { name: "‡§ü‡§Æ‡§æ‡§ü‡§∞", quantity: 1 }
            ],
            deliveryAddress: "123, ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§¨‡§æ‡§ú‡§æ‡§∞, ‡§∞‡§æ‡§ü‡•Ç ‡§ù‡§æ‡§∞‡§ñ‡§Ç‡§° 825301",
            phone: user.phone
          },
          {
            _id: "ORD-2025-002",
            totalAmount: 320,
            status: "shipped",
            createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),
            items: [
              { name: "‡§™‡•ç‡§Ø‡§æ‡§ú‡§º", quantity: 1.5 },
              { name: "‡§ó‡§æ‡§ú‡§∞", quantity: 1 }
            ],
            deliveryAddress: "123, ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§¨‡§æ‡§ú‡§æ‡§∞, ‡§∞‡§æ‡§ü‡•Ç ‡§ù‡§æ‡§∞‡§ñ‡§Ç‡§° 825301",
            phone: user.phone
          },
          {
            _id: "ORD-2025-003",
            totalAmount: 280,
            status: "confirmed",
            createdAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString(),
            items: [
              { name: "‡§≠‡§ø‡§Ç‡§°‡•Ä", quantity: 0.5 }
            ],
            deliveryAddress: "123, ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§¨‡§æ‡§ú‡§æ‡§∞, ‡§∞‡§æ‡§ü‡•Ç ‡§ù‡§æ‡§∞‡§ñ‡§Ç‡§° 825301",
            phone: user.phone
          }
        ];

        allOrders = mockOrders;
        clearTimeout(timeoutId);

        console.log("‚úÖ Orders loaded:", allOrders.length);
        renderOrders();
        updateFilterCounts();

      } catch (err) {
        console.error("‚ùå Error:", err);
        showPopup("‚ùå ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ", 'error');
        el("orderList").innerHTML = `
          <div class="empty-orders">
            <div class="empty-icon">‚ö†Ô∏è</div>
            <h3>‡§ï‡•Å‡§õ ‡§ó‡§≤‡§§ ‡§π‡•Å‡§Ü</h3>
            <p>‡§ë‡§∞‡•ç‡§°‡§∞ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§Ü‡§à</p>
            <button onclick="location.reload()">‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç</button>
          </div>
        `;
      }
    }

    // ============= RENDER ORDERS =============
    function renderOrders() {
      const container = el("orderList");

      let filteredOrders = allOrders;
      if (currentFilter !== 'all') {
        filteredOrders = allOrders.filter(order => 
          order.status?.toLowerCase() === currentFilter
        );
      }

      if (filteredOrders.length === 0) {
        container.innerHTML = `
          <div class="empty-orders">
            <div class="empty-icon">üì≠</div>
            <h3>‡§ï‡•ã‡§à ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ</h3>
            <p>‡§á‡§∏ ‡§∂‡•ç‡§∞‡•á‡§£‡•Ä ‡§Æ‡•á‡§Ç ‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à</p>
            <button onclick="window.location.href='profiles.html'">‡§ñ‡§∞‡•Ä‡§¶‡§æ‡§∞‡•Ä ‡§ï‡§∞‡•á‡§Ç</button>
          </div>
        `;
        return;
      }

      container.innerHTML = filteredOrders.map(order => `
        <div class="order-card">
          <div class="order-header">
            <div>
              <div class="order-id">
                ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§®‡§Ç‡§¨‡§∞
                <strong>${order._id}</strong>
              </div>
            </div>
            <span class="order-status ${getStatusBadgeClass(order.status)}">
              ${getStatusText(order.status)}
            </span>
          </div>

          <div class="order-content">
            <!-- Order Info Grid -->
            <div class="order-info">
              <div class="info-item">
                <span class="info-label">üìÖ ‡§§‡§æ‡§∞‡•Ä‡§ñ</span>
                <span class="info-value">${formatDate(order.createdAt)}</span>
              </div>
              <div class="info-item">
                <span class="info-label">‚è∞ ‡§∏‡§Æ‡§Ø</span>
                <span class="info-value">${formatTime(order.createdAt)}</span>
              </div>
              <div class="info-item">
                <span class="info-label">üí∞ ‡§ï‡•Å‡§≤ ‡§∞‡§ï‡§Æ</span>
                <span class="info-value amount">‚Çπ${order.totalAmount}</span>
              </div>
              <div class="info-item">
                <span class="info-label">üì± ‡§´‡•ã‡§®</span>
                <span class="info-value">${order.phone}</span>
              </div>
            </div>

            <!-- Items -->
            <div class="order-items">
              <div class="items-title">üõí ‡§∏‡§æ‡§Æ‡§æ‡§®</div>
              <ul class="item-list">
                ${order.items.map(item => `
                  <li>
                    <span class="item-name">${item.name}</span>
                    <span class="item-qty">${item.quantity} ‡§ï‡§ø‡§≤‡•ã</span>
                  </li>
                `).join('')}
              </ul>
            </div>

            <!-- Address -->
            <div class="order-address">
              <div class="address-label">üè† ‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§™‡§§‡§æ</div>
              ${order.deliveryAddress}
            </div>

            <!-- Actions -->
            <div class="order-actions">
              <button class="action-btn primary" onclick="trackOrder('${order._id}')">
                üöö ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡•á‡§Ç
              </button>
              <button class="action-btn" onclick="reorder('${order._id}')">
                üîÑ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡§∞‡•á‡§Ç
              </button>
            </div>
          </div>
        </div>
      `).join('');

      console.log("‚úÖ Rendered:", filteredOrders.length, "orders");
    }

    // ============= FILTER ORDERS =============
    function filterOrders(status) {
      currentFilter = status;

      // Update active button
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');

      renderOrders();
    }

    // ============= UPDATE FILTER COUNTS =============
    function updateFilterCounts() {
      const counts = {
        all: allOrders.length,
        pending: allOrders.filter(o => o.status?.toLowerCase() === 'pending').length,
        confirmed: allOrders.filter(o => o.status?.toLowerCase() === 'confirmed').length,
        shipped: allOrders.filter(o => o.status?.toLowerCase() === 'shipped').length,
        delivered: allOrders.filter(o => o.status?.toLowerCase() === 'delivered').length
      };

      const buttons = document.querySelectorAll('.filter-btn');
      buttons[0].textContent = `‡§∏‡§≠‡•Ä (${counts.all})`;
      buttons[1].textContent = `‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ (${counts.pending})`;
      buttons[2].textContent = `‡§™‡•Å‡§∑‡•ç‡§ü (${counts.confirmed})`;
      buttons[3].textContent = `‡§≠‡•á‡§ú‡•á ‡§ó‡§è (${counts.shipped})`;
      buttons[4].textContent = `‡§™‡§π‡•Å‡§Ç‡§ö‡•á (${counts.delivered})`;
    }

    // ============= GET STATUS TEXT =============
    function getStatusText(status) {
      const statusMap = {
        'pending': '‚è≥ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ',
        'confirmed': '‚úì ‡§™‡•Å‡§∑‡•ç‡§ü',
        'shipped': 'üöö ‡§≠‡•á‡§ú‡•á ‡§ó‡§è',
        'delivered': '‚úì‚úì ‡§™‡§π‡•Å‡§Ç‡§ö‡•á',
        'cancelled': '‚úó ‡§∞‡§¶‡•ç‡§¶'
      };
      return statusMap[status?.toLowerCase()] || '‚è≥ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ';
    }

    // ============= TRACK ORDER =============
    function trackOrder(orderId) {
      showPopup(`üìç ‡§ë‡§∞‡•ç‡§°‡§∞ ${orderId} ‡§ï‡•ã ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...`);
      console.log("üöö Tracking order:", orderId);
      // Backend integration
    }

    // ============= REORDER =============
    function reorder(orderId) {
      showPopup(`üîÑ ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§¨‡§®‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...`);
      console.log("üîÑ Reordering:", orderId);
      setTimeout(() => {
        window.location.href = 'profiles.html';
      }, 1500);
    }

    // ============= PAGE LOAD =============
    window.addEventListener('DOMContentLoaded', () => {
      console.log("‚úÖ Order page loaded");

      const token = localStorage.getItem("token");
      const user = JSON.parse(localStorage.getItem("userData"));

      if (!token || !user) {
        console.warn("‚ùå No valid session");
        localStorage.clear();
        window.location.replace("login.html");
        return;
      }

      fetchOrders();
    });

    // ============= ERROR HANDLING =============
    window.addEventListener('error', (event) => {
      console.error('‚ùå Global error:', event.error);
    });
  </script>
</body>
</html>
